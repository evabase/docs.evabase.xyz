---
title: "创建计划任务"
type: docs
weight: 31
---

Evabase 支持自定义任务，允许将多笔交易合并成一笔交易，并允许设置执行计划。

导航路径：[App Home](https://app.evabase.net) / [Create](https://app.evabase.xyz/create) 。


{{% pageinfo color="primary" %}}
通过本文学习，您将学会使用 Evabase 创建自定义计划任务。
{{% /pageinfo %}}


## 场景 {#case}

Evabase 当前版本只实现了 Execute 控件，后续将陆续提供其他功能性控件，如：Uniswap 兑换控件，Compound 存款控件等等。利用丰富的控件，可以如同积木一样搭建更丰富的交互场景：

1. 定投：固定每周买入 200 USDT 的 BTC。
2. 工资发放：固定每月一号发放 ETH 工资给员工。
3. 抢公售NFT：提前创建  Mint 任务，让 Evabase 在第一时间 Mint  NFT ，不用担心错过时间。
4. 交易：设定 ETH 下跌 10% 则立即买入，并可设置挂单卖出价格。
5. GameFi: 定期自动和游戏交互。
6. 复投：定期定量将挖矿代币存入抵押池或卖出再投资。
7. ...

利用 Evabase 控件积木组合能力，让 Evabase 帮你实现低代码编程，减轻运维烦恼。

## 计划任务 {#taskPage}

进入计划任务页面，默认只展示一个 Execute 执行面板。其他信息随着不断交互操作，会实时显示。

![计划任务](/img/task01.png)

## 操作步骤

提交计划任务，需要完成四个操作：

1. 设置执行内容：填写合约地址和合约方法。
2. 设置执行计划：多种方式设置任务执行触发器。
3. 自定义名称。
4. 提交任务。


{{% alert title="提示" color="primary" %}}
下文将以测试环境中的 ERC20 Token 为例，创建铸币任务：

设定每分钟执行一次铸币，并将代币转入到指定钱包中。
{{% /alert %}}

### 设置执行内容

自定义任务需要用户自行输入待执行的合约信息，系统将自根据输入的合约地址，自动分析合约接口。如果合约已开源则能自动加载并显示合约所有能执行的合约接口，如果加载失败，则说明合约尚未开源，用户可自行填写合约接口。

➊ 将合约地址`0xC272e20C2d0F8fb7B9B05B9F2Ba4407E95928CbF` 填写到输入框中。
➋ 因为该 Token 合约源代码已开源，Evabase 将能自动显示 Token 接口。
➌ 点击会展开显示所有合约接口，从中选择目标 `mint(uint256 amount)`方法。

![计划任务](/img/task02.png)

此时，➊ 输入铸币数量， ➋ 并点击`+`按钮再添加一个 Execute 控件。
![计划任务](/img/task03.png)

在 `Execute2` 中，输入合约地址后，选择 `transfer` 方法。因为 `transfer` 有两个参数：`to` 表示 Token 接收人地址，`amount` 表示转账数量。要输入的参数个数由选择的接口方法决定。

![计划任务](/img/task04.png)


{{% alert title="提示" color="primary" %}}
在以太坊网络中，可试试输入 USDT 合约地址 `0xdac17f958d2ee523a2206206994597c13d831ec7`。记得，先在钱包中选择 `Ethereum Mainnet` 网络。
{{% /alert %}}


{{% alert title="提示" color="primary" %}}
Execute 控件可通过鼠标按住 Execute 名称，拖动修改执行顺序。
{{% /alert %}}


{{% alert title="警告" color="warning" %}}

Evabase 执行 Execute 控件内容的主体(`msg.sender`)是钱包保险箱。如果任务涉及从用户钱包转移资产，则需要先将资产授权给保险箱。

当前版本 Evabase 咱无相关检测提示。

{{% /alert %}}

###  设置执行计划

设置好执行内容后，系统将自动显示执行计划设置面板。

![计划任务](/img/task05.png)

Evabase 支持三种执行模式：

1. Time - 定时器模式：设定执行间隔，定时自动执行。
2. Whennever possible - 永动模式：只要系统能够发送交易，则尽可能的发送执行指令。最高频率是每个区块中执行一次任务。
3. Resolver - 自定义模式：需要用户自行编写符合规范的触发器合约，Evabase 将一直监控触发器，一旦触发器告知可以执行，Evabase 将立即响应执行一次。（当前 Evabase 尚未开放该模式）

定时器模式是常规使用方式，允许设置更多与执行相关的参数。
➊ One-time: 勾选表示只执行一次，不论执行成功与否，立即关闭任务。
➋ Interval：默认选项，可设置执行周期。在任务有效期内将按时间间隔执行任务。
➌ Effective immediately: 默认勾选，表示任务立即生效。也可以不勾选，自定义任务生效开始时间。如下图设定的生效时间为2022年7月4日 00:06:00 时。

![计划任务](/img/task07.png)


###  自定义名称

确定任务后，还需设定任务名称和追加 Gas 预付：

1. ➊ Fund Balance: 钱包在 Evabase 中预留的 Gas 资金。用于任务自动执行时代扣 Gas 费。如果 Fund Balance 为零或者不足时，即使创建了任务，任务也不会自动执行，直达 Fund Balance 充足。
2. ➌ Task Name: 限价单任务名，可自定义，名字越短越节省 Gas。一经确定，任务名称不可修改。这里➋显示的是上文中将执行的合约方法，供点击快速带入到任务名中。

![计划任务](/img/task08.png)



## 提交任务 {#submit}

点击`Submit`将提交任务到网络中，更多细节请参见 [提交任务]({{< ref "submitTask.md" >}}) 文档。

![提交任务](/img/task09.png)

## 查看任务 {#see}

成功创建任务后，查看任务有一定的延迟，需等待 5~30 秒才能在[我的任务]({{< ref "tasks.md">}})页面中查看。

下方是刚在测试网络中创建的计划任务详情：

![计划任务列表](/img/task11.png)
![计划任务明细](/img/task12.png)

<!-- ➊ ➋ ➌ ➍ ➎ ➏ ➐ ➑ ➒ ➓ -->
